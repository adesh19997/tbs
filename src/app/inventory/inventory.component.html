<section style="padding:25px;" *ngIf="!data.loading && data.bShowAdminPage">
  <div class="row" *ngIf="!addProd">
    <div class="col-md-6 col-sm-6 col-lg-6">
      <h4>Product List</h4>
    </div>
    <div class="col-md-6 col-sm-6 col-lg-6 text-right">
        <button matButton type="button" class="basicbutton" (click)="openPopup(addFile)"> Update Inventory</button>
      <button matButton type="button" class="basicbutton" (click)="downloadProductList()"> Download History</button>
    </div>
  </div>
  <hr>
  <div class="row" *ngIf="!addProd">
    <div class="col-md-12" id="print-section">
      <table class="table text-left">
        <tbody>
          <tr>
            <th>Sr.No</th>
            <th (click)="sortTable('ProductList','sUid')">Product ID
              <a class="text-left" (click)="sortTable('ProductList','sUid')">
                <i class="fa fa-caret-up" *ngIf="dir!='asc'"></i>
                <i class="fa fa-caret-down" *ngIf="dir=='asc'"></i>
              </a>
            </th>
            <th (click)="sortTable('ProductList','sName')">Product Name
              <a class="text-left" (click)="sortTable('ProductList','sName')">
                <i class="fa fa-caret-up" *ngIf="dir!='asc'"></i>
                <i class="fa fa-caret-down" *ngIf="dir=='asc'"></i>
              </a>
            </th>
            <th (click)="sortTable('ProductList','dStockAvailable')">Stock Available
              <a class="text-left" (click)="sortTable('ProductList','dStockAvailable')">
                <i class="fa fa-caret-up" *ngIf="dir!='asc'"></i>
                <i class="fa fa-caret-down" *ngIf="dir=='asc'"></i>
              </a>
            </th>
            <th>
              <a id='addID' (click)="addProduct()" title="Edit">
                <i class="fa fa-plus"></i> Add
              </a>
            </th>
          </tr>
          <tr *ngFor="let prod of data.Products;let ind=index;">
            <td>{{ind +1}}</td>
            <td (click)="editProduct(ind)" class="viewData">{{prod.sUid}}</td>
            <td (click)="editProduct(ind)">{{prod.sName}}</td>
            <td>{{prod.dStockAvailable}}</td>
            <td>
              <a id='editID' (click)="editProduct(ind)" title="Edit">
                <i class="fa fa-edit"></i>
              </a>
              <a id="cancelEditId" (click)="deleteProduct(ind)" title="Delete">
                <i class="fa fa-remove fa-lg"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="row" *ngIf="addProd">
    <div class="col-md-6 col-sm-6 col-lg-6">
      <h4>Product Details</h4>
    </div>
    <div class="col-md-4 col-sm-4 col-lg-4 text-right">
      <button matButton type="button" class="basicbutton" (click)="back()"> Back</button>
    </div>
    <div class="col-md-2 col-sm-2 col-lg-2 text-right">
      <button matButton type="button" class="basicbutton" (click)="saveNewProd()"> Save Changes</button>
    </div>
  </div>
  <hr>
  <div class="row" *ngIf="addProd">
    <div class="col-md-4 col-sm-4 col-lg-4" *ngFor="let fi of addField">
      <app-field [field]="fi" [form]="addform"></app-field>
    </div>
  </div>
  <div class="row card" style="margin-top:20px;padding: 3px;" *ngIf="addProd">
    <div class="col-md-12 col-sm-12 col-lg-12 ">
      <mat-form-field class="remarks-area example-full-width">
        <textarea matInput matTextareaAutosize name="Remarks" placeholder="Product Description"
          [(ngModel)]="Product.sProductDesc"></textarea>
      </mat-form-field>
    </div>
  </div>
  <hr>
  <div class="row" *ngIf="addProd && Product.sMultipleSize =='Yes'">
    <div class="col-md-12 col-sm-12 col-lg-12">
      <h4>Size Details</h4>
    </div>
  </div>
  <hr>
  <div class="row " *ngIf="addProd && Product.sMultipleSize =='Yes'">
    <div class="col-md-12">
      <table class="table">
        <tbody>
          <tr class="borderStyle">
            <th class="borderStyle">Sr No.</th>
            <th class="borderStyle">Size </th>
            <th class="borderStyle">Price</th>
            <th>
              <a id='addID' (click)="addSize()" title="Edit">
                <i class="fa fa-plus"></i> Add
              </a>
            </th>
          </tr>
          <tr class="borderStyle" *ngFor="let size of Product.aSizeList;let ind=index">
            <td>{{ind +1}}</td>
            <td>
              <mat-form-field class="example-full-width">
                <mat-select id="size-{{ind}}" name="size-{{ind}}" placeholder="Size" [(ngModel)]="size.sSize">
                  <mat-option *ngFor="let opt of aSizes" [value]="opt.value">{{
                        opt.viewValue }}</mat-option>
                </mat-select>
                <mat-error [hidden]="!isValid">
                  <span>Please enter correct value of {{field.sPlaceholder}}.</span>
                </mat-error>
              </mat-form-field>
            </td>
            <td>
              <mat-form-field class="example-full-width">
                <input type="number" matInput id="price-{{ind}}" name="price-{{ind}}" placeholder="Price"
                  [(ngModel)]="size.dAmount">
              </mat-form-field>
            </td>
            <td>
              <a id="cancelEditId" (click)="deleteSize(ind)" title="Delete">
                <i class="fa fa-remove fa-lg"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <hr>
  <div class="row white" *ngIf="addProd">
    <div class="col-md-12 col-sm-12 col-lg-12 text-right">
      <button matButton type="button" class="basicbutton" (click)="validate()"> Add Product</button>
    </div>
  </div>
  <hr>
  <div class="row" *ngIf="addProd && addImg">
    <div class="col-md-6 col-sm-6 col-lg-6">
      <h4>Product Images</h4>
    </div>
    <div class="col-md-6 col-sm-6 col-lg-6 text-right">
      <button matButton type="button" class="basicbutton" (click)="addImgetoProd()"> Add Image</button>
    </div>
  </div>
  <hr>
  <div class="row white" *ngIf="addProd && addImg">
    <div class="col-md-12" *ngIf="addProd && addImg" style="padding-left:0px;padding-right:0px;">
      <mat-grid-list cols="3" rowHeight="1:1">
        <mat-grid-tile *ngFor="let image of Product.aImages;let ind=index;">
          <div class="row" *ngIf="image.state != 'running'">
            <input type="file" id="{{Product.sName+ind}}" name="{{Product.sName+ind}}" accept="image/*" #fileInput
              (click)="fileInput.value = null" value="" (change)="addImage($event ,image,ind)">
            <label for="{{Product.sName+ind}}">
              <img [src]="image.downloadURL">
            </label>
          </div>
          <mat-progress-bar *ngIf="image.state === 'running'" mode="indeterminate"></mat-progress-bar>
        </mat-grid-tile>
      </mat-grid-list>
    </div>
  </div>
  <hr>
  <div class="row" *ngIf="addProd && addImg">
    <div class="col-md-6 col-sm-6 col-lg-6">
      <h4>Stock History</h4>
    </div>
    <div class="col-md-6 col-sm-6 col-lg-6 text-right">
      <button matButton type="button" class="basicbutton" (click)="downloadMaster()"> Download History</button>
    </div>
  </div>
  <div class="row" *ngIf="addProd && addImg">
    <div class="col-md-12">
      <table class="table">
        <tbody>
          <tr>
            <th>Sr No.</th>
            <th (click)="sortTable('Stock','dtDate')">Transaction Date
              <a class="text-left" (click)="sortTable('Stock','dtDate')">
                <i class="fa fa-caret-up" *ngIf="dir!='asc'"></i>
                <i class="fa fa-caret-down" *ngIf="dir=='asc'"></i>
              </a>
            </th>
            <th (click)="sortTable('Stock','sAction')">Action
              <a class="text-left" (click)="sortTable('Stock','sAction')">
                <i class="fa fa-caret-up" *ngIf="dir!='asc'"></i>
                <i class="fa fa-caret-down" *ngIf="dir=='asc'"></i>
              </a>
            </th>
            <th (click)="sortTable('Stock','dQuantity')">Quantity
              <a class="text-left" (click)="sortTable('Stock','dQuantity')">
                <i class="fa fa-caret-up" *ngIf="dir!='asc'"></i>
                <i class="fa fa-caret-down" *ngIf="dir=='asc'"></i>
              </a>
            </th>
            <th>
              <a id='addID' (click)="addStock(addStockPop)" title="Edit">
                <i class="fa fa-plus"></i> Add
              </a>
            </th>
          </tr>
          <tr *ngFor="let stock of Stocks;let ind=index">
            <td>{{ind + 1}}</td>
            <td>{{stock.dtDate | date: 'dd/MM/yyyy, h:mm a'}}</td>
            <td>{{stock.sAction}}</td>
            <td>{{stock.dQuantity}}</td>
            <td>
              <a id="cancelEditId" (click)="deleteStock(ind)" title="Delete">
                <i class="fa fa-remove fa-lg"></i>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>

<ng-template #addStockPop let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4>Add Stock</h4>
    <button id="inv1" type="button" class="close" aria-label="Close" (click)="c('Close click')"
      style="float:right;padding-top: 0px;">&times;</button>
  </div>
  <div class="modal-body">
    <div class="row ">
      <div class="col-md-4 col-sm-4 col-lg-4" *ngFor="let fi of stockField">
        <app-field [field]="fi" [form]="stockform"></app-field>
      </div>
    </div>
    <hr>
    <div class="row ">
      <div class="col-md-12 col-sm-12 col-lg-12">
        <h4>Stock Received from</h4>
      </div>
    </div>
    <hr>
    <div class="row ">
      <div class="col-md-4 col-sm-4 col-lg-4" *ngFor="let fi of addrField">
        <app-field [field]="fi" [form]="stockRecform"></app-field>
      </div>
    </div>
    <hr>
    <div class="row ">
      <div class="col-md-12 col-sm-12 col-lg-12">
        <h4>Stock Delivered To</h4>
      </div>
    </div>
    <hr>
    <div class="row ">
      <div class="col-md-4 col-sm-4 col-lg-4" *ngFor="let fi of addrField">
        <app-field [field]="fi" [form]="stockDelform"></app-field>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button matButton type="button" class="basicbutton" (click)="SaveStock()"> Add</button>
  </div>
</ng-template>
<ng-template #addFile let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4>Upload</h4>
  </div>
  <div class="modal-body">
    <div class="row" *ngIf="!isLoading">
      <div class="col-md-6 col-sm-6 col-lg-6">
        <label class="btn-bs-file btn btn-md btn-primary">
          <i class="fa fa-random"></i> Add
          <input type="file" style="display: none;" class="fileInput" id="importLeads" #fileInput
            (click)="fileInput.value = null" name="importLeads" (change)="uploadFile($event,addMaster);">
        </label>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button id='control33' mat-button type="button" class="btn btn-primary" (click)="closePopup()">Close</button>
  </div>
</ng-template>